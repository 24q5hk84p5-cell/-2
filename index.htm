<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×‘× ×§ ×›×™×ª×” ×—/2</title>
    <style>
        :root {
            --gold: #f1c40f;
            --gold-shadow: rgba(241, 196, 15, 0.5);
            --primary: #4a90e2;
            --success: #2ecc71;
            --danger: #e74c3c;
            --bg: #f0f2f5;
        }

        body { font-family: 'Segoe UI', system-ui, sans-serif; background-color: var(--bg); margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        header { text-align: center; margin-bottom: 30px; position: relative; }
        .slogan { font-style: italic; color: #555; font-size: 1.4em; margin: 15px 0; font-weight: bold; border-right: 5px solid var(--primary); padding-right: 15px; display: inline-block; }
        
        /* ×ª×¦×•×’×ª ×ª××•× ×” */
        .class-img-container { width: 100%; height: 300px; overflow: hidden; border-radius: 15px; box-shadow: inset 0 0 20px rgba(0,0,0,0.1); background: #dfe6e9; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; }
        .class-img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s; }

        /* ×¤×•×“×™×•× */
        .podium { display: flex; justify-content: center; align-items: flex-end; gap: 20px; margin: 40px 0; height: 200px; }
        .podium-place { text-align: center; width: 120px; border-radius: 15px 15px 5px 5px; position: relative; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        
        .first { 
            height: 180px; background: linear-gradient(135deg, #f1c40f, #f39c12); color: white; 
            animation: shine 2s infinite; border: 2px solid gold;
        }
        @keyframes shine {
            0% { box-shadow: 0 0 5px var(--gold-shadow); }
            50% { box-shadow: 0 0 25px var(--gold-shadow); }
            100% { box-shadow: 0 0 5px var(--gold-shadow); }
        }

        .second { height: 130px; background: linear-gradient(135deg, #bdc3c7, #95a5a6); color: white; }
        .third { height: 100px; background: linear-gradient(135deg, #e67e22, #d35400); color: white; }

        /* ×˜×‘×œ×” */
        table { width: 100%; border-collapse: separate; border-spacing: 0 10px; }
        th { padding: 15px; color: #777; font-weight: 600; border-bottom: 2px solid #eee; }
        tr.top-student { background: #fffdf0; transform: scale(1.01); box-shadow: 0 2px 10px rgba(241, 196, 15, 0.2); }
        td { padding: 15px; text-align: center; background: #fff; border-top: 1px solid #eee; border-bottom: 1px solid #eee; }
        td:first-child { border-right: 1px solid #eee; border-radius: 0 10px 10px 0; }
        td:last-child { border-left: 1px solid #eee; border-radius: 10px 0 0 10px; }

        .btn-plus { background: var(--success); color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-minus { background: var(--danger); color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-plus:hover, .btn-minus:hover { transform: translateY(-2px); opacity: 0.9; }

        /* ×—× ×•×ª */
        .shop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .shop-item { background: white; border: 2px solid #eef2f7; padding: 20px; border-radius: 15px; text-align: center; transition: 0.3s; }
        .shop-item:hover { border-color: var(--primary); transform: translateY(-5px); }
        .shop-item b { font-size: 1.2em; color: var(--primary); display: block; margin-bottom: 10px; }

        /* × ×™×”×•×œ */
        .admin-section { display: none; background: #2d3436; color: white; margin-top: 50px; padding: 30px; border-radius: 20px; }
        .card { background: #353b48; padding: 20px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #4b515d; }
        .toggle-btn { position: fixed; bottom: 30px; left: 30px; background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 5px 20px rgba(74, 144, 226, 0.4); z-index: 100; }
        
        .history-log { font-size: 0.85em; background: #f8f9fa; border-radius: 8px; padding: 8px; max-height: 80px; overflow-y: auto; border: 1px solid #eee; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="class-img-container" id="img-frame">
            <img id="class-banner" src="" class="class-img" style="display:none;">
            <div id="placeholder-text" style="color:#636e72;">ğŸ“¸ ×”×¢×œ×” ×ª××•× ×” ×‘×ª×¤×¨×™×˜ ×”× ×™×”×•×œ</div>
        </div>
        <h1 style="font-size: 2.5em; margin: 10px 0;">×‘× ×§ ×›×™×ª×” ×—/2</h1>
        <div class="slogan" id="slogan-text">"××œ ×ª×”×™×• ×›×¢×‘×“×™× ×”××©××©×™× ××ª ×”×¨×‘ ×¢×œ ×× ×ª ×œ×§×‘×œ ×¤×¨×¡..."</div>
    </header>

    <div id="podium-area" class="podium"></div>

    <div id="student-view">
        <h3 style="display: flex; align-items: center; gap: 10px;">ğŸ† ×˜×‘×œ×ª ×”× ×™×§×•×“ ×”×›×™×ª×ª×™×ª</h3>
        <table>
            <thead>
                <tr>
                    <th>××§×•×</th>
                    <th>×©× ×”×ª×œ××™×“/×”</th>
                    <th>×™×ª×¨×” ×‘×‘× ×§</th>
                    <th>×¢×“×›×•×Ÿ ×©×™×¢×•×¨</th>
                    <th>×¤×¢×•×œ×•×ª ××—×¨×•× ×•×ª</th>
                </tr>
            </thead>
            <tbody id="student-table-body"></tbody>
        </table>

        <h3 style="margin-top: 40px;">ğŸ›’ ××¨×›×– ×”×”×˜×‘×•×ª</h3>
        <div id="shop-display" class="shop-grid"></div>
    </div>

    <div id="teacher-view" class="admin-section">
        <h2 style="border-bottom: 1px solid #636e72; padding-bottom: 10px;">âš™ï¸ ×¤×× ×œ × ×™×”×•×œ ××•×¨×”</h2>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="card">
                <h4>ğŸ–¼ï¸ ××¨××” ×•×¢×™×¦×•×‘</h4>
                <label>×ª××•× ×ª ×›×™×ª×”:</label><br>
                <input type="file" accept="image/*" onchange="handleImageUpload(this)" style="margin: 10px 0;"><br>
                <label>×¡×œ×•×’×Ÿ:</label><br>
                <input type="text" id="new-slogan" placeholder="×”×›× ×¡ ×¡×œ×•×’×Ÿ ×—×“×©" style="padding: 8px; width: 70%;">
                <button onclick="updateSlogan()" style="padding: 8px 15px; cursor:pointer;">×¢×“×›×Ÿ</button>
            </div>

            <div class="card">
                <h4>ğŸ› ï¸ ×©×œ×™×˜×” ×‘××¢×¨×›×ª</h4>
                <button onclick="undoLastAction()" style="background:#636e72; color:white; padding:10px; border:none; border-radius:5px; cursor:pointer; width: 100%; margin-bottom: 10px;">â†©ï¸ ×©×—×–×•×¨ ×¤×¢×•×œ×” ××—×¨×•× ×” (Undo)</button>
                <button onclick="resetAll()" style="background:var(--danger); color:white; padding:10px; border:none; border-radius:5px; cursor:pointer; width: 100%;">âš ï¸ ××™×¤×•×¡ ×›×œ×œ×™ (×—×–×¨×” ×œ-100)</button>
            </div>

            <div class="card">
                <h4>ğŸ × ×™×”×•×œ ×—× ×•×ª</h4>
                <input type="text" id="item-name" placeholder="×©× ×”×¦'×•×¤×¨">
                <input type="number" id="item-price" placeholder="××—×™×¨">
                <button onclick="addItem()" style="background:var(--success); color:white; border:none; padding:8px; border-radius:5px; cursor:pointer;">×”×•×¡×£</button>
            </div>
        </div>
    </div>
</div>

<button id="view-toggle" class="toggle-btn" onclick="toggleView()">ğŸ”“ ×›× ×™×¡×” ×œ××¦×‘ ××•×¨×”</button>

<script>
    let students = [
        { name: "××‘×™×‘ ×œ×•×™", points: 100, history: ["×¤×ª×™×—×ª ×—×©×‘×•×Ÿ: 100"] },
        { name: "× ×•×¢×” ×›×”×Ÿ", points: 100, history: ["×¤×ª×™×—×ª ×—×©×‘×•×Ÿ: 100"] },
        { name: "××™×ª×™ ××–×¨×—×™", points: 100, history: ["×¤×ª×™×—×ª ×—×©×‘×•×Ÿ: 100"] },
        { name: "××™×›×œ ××‘×¨×”×", points: 100, history: ["×¤×ª×™×—×ª ×—×©×‘×•×Ÿ: 100"] }
    ];

    let shopItems = [
        { name: "×‘×—×™×¨×ª ××§×•× ×™×©×™×‘×”", price: 60 },
        { name: "×¤×˜×•×¨ ××©×™×¢×•×¨×™ ×‘×™×ª", price: 100 }
    ];

    let historyStack = [];

    function handleImageUpload(input) {
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = e => {
                document.getElementById('class-banner').src = e.target.result;
                document.getElementById('class-banner').style.display = 'block';
                document.getElementById('placeholder-text').style.display = 'none';
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function render() {
        const sorted = [...students].sort((a, b) => b.points - a.points);
        
        // ×¤×•×“×™×•×
        const podiumArea = document.getElementById('podium-area');
        podiumArea.innerHTML = `
            <div class="podium-place second">ğŸ¥ˆ<br><small>${sorted[1]?.name || '-'}</small><br>${sorted[1]?.points || 0}</div>
            <div class="podium-place first">ğŸ‘‘ğŸ¥‡<br><b>${sorted[0]?.name || '-'}</b><br>${sorted[0]?.points || 0}</div>
            <div class="podium-place third">ğŸ¥‰<br><small>${sorted[2]?.name || '-'}</small><br>${sorted[2]?.points || 0}</div>
        `;

        // ×˜×‘×œ×”
        const tableBody = document.getElementById('student-table-body');
        tableBody.innerHTML = '';
        sorted.forEach((s, index) => {
            const originalIndex = students.findIndex(st => st.name === s.name);
            const isTop = index === 0;
            tableBody.innerHTML += `
                <tr class="${isTop ? 'top-student' : ''}">
                    <td><b>${index + 1}</b></td>
                    <td>${isTop ? 'â­ ' : ''}${s.name}</td>
                    <td><b style="font-size: 1.3em; color: ${isTop ? '#f39c12' : 'var(--primary)'}">${s.points}</b></td>
                    <td>
                        <button class="btn-plus" onclick="changePoints(${originalIndex}, 5, '×”×ª× ×”×’×•×ª ×˜×•×‘×”')">+5</button>
                        <button class="btn-minus" onclick="changePoints(${originalIndex}, -5, '×”×¤×¨×¢×”/××™×—×•×¨')">-5</button>
                    </td>
                    <td><div class="history-log">${s.history.slice(-3).reverse().map(h => `â€¢ ${h}`).join('<br>')}</div></td>
                </tr>
            `;
        });

        // ×—× ×•×ª
        const shopDiv = document.getElementById('shop-display');
        shopDiv.innerHTML = '';
        shopItems.forEach(item => {
            shopDiv.innerHTML += `
                <div class="shop-item">
                    <b>${item.name}</b>
                    <span>ğŸ’° ${item.price} × ×§×•×“×•×ª</span>
                </div>
            `;
        });
    }

    function changePoints(index, amount, reason) {
        if(confirm(`×œ××©×¨ ${amount} × ×§×•×“×•×ª ×œ${students[index].name}?`)) {
            saveState();
            students[index].points += amount;
            students[index].history.push(`${reason} (${amount > 0 ? '+' : ''}${amount})`);
            render();
        }
    }

    function toggleView() {
        const admin = document.getElementById('teacher-view');
        const btn = document.getElementById('view-toggle');
        const isVisible = admin.style.display === 'block';
        admin.style.display = isVisible ? 'none' : 'block';
        btn.innerText = isVisible ? 'ğŸ”“ ×›× ×™×¡×” ×œ××¦×‘ ××•×¨×”' : 'ğŸ”’ ×—×–×¨×” ×œ×ª×¦×•×’×ª ×ª×œ××™×“×™×';
        btn.style.background = isVisible ? 'var(--primary)' : '#2d3436';
    }

    function updateSlogan() {
        const val = document.getElementById('new-slogan').value;
        if(val) { document.getElementById('slogan-text').innerText = val; alert("×”×¡×œ×•×’×Ÿ ×¢×•×“×›×Ÿ!"); }
    }

    function addItem() {
        const name = document.getElementById('item-name').value;
        const price = document.getElementById('item-price').value;
        if(name && price) {
            shopItems.push({name, price: parseInt(price)});
            render();
        }
    }

    function saveState() {
        historyStack.push(JSON.stringify(students));
    }

    function undoLastAction() {
        if(historyStack.length > 0) {
            students = JSON.parse(historyStack.pop());
            render();
        } else { alert("××™×Ÿ ××” ×œ×©×—×–×¨"); }
    }

    function resetAll() {
        if(confirm("×‘×˜×•×—? ×›×•×œ× ×™×—×–×¨×• ×œ-100 × ×§×•×“×•×ª.")) {
            saveState();
            students.forEach(s => { s.points = 100; s.history = ["××™×¤×•×¡: 100"]; });
            render();
        }
    }

    render();
</script>
</body>
</html>
